:root {
  --bg:#f4f6fa; --surface:#fff; --surface2:#f8f9fc;
  --border:#e2e6ef; --border2:#c8cedc;
  --text:#0f1623; --text-dim:#4b5568; --text-muted:#8492a6;
  --critical:#d0021b; --critical-bg:#fff1f3; --critical-bd:#fca5a5;
  --high:#c2410c;    --high-bg:#fff7ed;    --high-bd:#fdba74;
  --moderate:#b45309;--moderate-bg:#fffbeb;--moderate-bd:#fcd34d;
  --good:#166534;    --good-bg:#f0fdf4;    --good-bd:#86efac;
  --neutral:#1d4ed8; --neutral-bg:#eff6ff; --neutral-bd:#93c5fd;
  --info:#374151;    --info-bg:#f9fafb;    --info-bd:#d1d5db;
  --accent:#0f766e;  --accent-bg:#f0fdfa;  --accent-bd:#5eead4;
  --warning:#d97706; --warning-bg:#fffbeb; --warning-bd:#fcd34d;
}
[data-theme="dark"] {
  --bg:#080b10; --surface:#0f1319; --surface2:#141922;
  --border:rgba(255,255,255,0.08); --border2:rgba(255,255,255,0.15);
  --text:#e8eaf0; --text-dim:#9ca3b8; --text-muted:#4b5568;
  --critical:#ff4d6a; --critical-bg:rgba(255,77,106,0.12);  --critical-bd:rgba(255,77,106,0.4);
  --high:#fb923c;    --high-bg:rgba(251,146,60,0.12);   --high-bd:rgba(251,146,60,0.4);
  --moderate:#fbbf24;--moderate-bg:rgba(251,191,36,0.12);--moderate-bd:rgba(251,191,36,0.4);
  --good:#4ade80;    --good-bg:rgba(74,222,128,0.10);   --good-bd:rgba(74,222,128,0.4);
  --neutral:#60a5fa; --neutral-bg:rgba(96,165,250,0.10); --neutral-bd:rgba(96,165,250,0.35);
  --info:#94a3b8;    --info-bg:rgba(148,163,184,0.08);  --info-bd:rgba(148,163,184,0.25);
  --accent:#2dd4bf;  --accent-bg:rgba(45,212,191,0.08); --accent-bd:rgba(45,212,191,0.4);
  --warning:#fbbf24; --warning-bg:rgba(251,191,36,0.12); --warning-bd:rgba(251,191,36,0.4);
}
[data-theme="dark"] body { background-image: radial-gradient(ellipse 70% 40% at 50% -5%,rgba(255,77,106,.05) 0%,transparent 60%),radial-gradient(ellipse 40% 30% at 85% 85%,rgba(96,165,250,.04) 0%,transparent 60%); }
[data-theme="dark"] .p-critical { background:rgba(255,77,106,.05); }
[data-theme="dark"] .p-critical:hover,[data-theme="dark"] .p-critical.expanded { background:rgba(255,77,106,.09); }
[data-theme="dark"] .slider-track { background:rgba(255,255,255,.06); }
[data-theme="dark"] .z1{background:rgba(74,222,128,.3)}[data-theme="dark"] .z2{background:rgba(96,165,250,.22)}
[data-theme="dark"] .z3{background:rgba(251,191,36,.22)}[data-theme="dark"] .z4{background:rgba(255,77,106,.3)}
[data-theme="dark"] .slider-indicator{border-color:#080b10}
[data-theme="dark"] .f-count{background:rgba(255,255,255,.1)}

*{margin:0;padding:0;box-sizing:border-box}
body{background:var(--bg);color:var(--text);font-family:'DM Sans',sans-serif;min-height:100vh;padding:40px 24px 80px;transition:background .25s}
.wrapper{max-width:1020px;margin:0 auto}

/* HEADER */
.header{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:26px 30px;display:flex;justify-content:space-between;align-items:flex-start;gap:24px;margin-bottom:14px;box-shadow:0 1px 4px rgba(0,0,0,.06);transition:background .25s,border-color .25s}
.brand{display:flex;align-items:center;gap:9px;margin-bottom:12px}
.brand-mark{width:28px;height:28px;background:linear-gradient(135deg,#0f766e,#1d4ed8);border-radius:6px;display:flex;align-items:center;justify-content:center;font-family:'DM Mono',monospace;font-size:11px;font-weight:500;color:#fff}
.brand-name{font-family:'Fraunces',serif;font-size:14px;font-weight:600}
.deal-title{font-family:'Fraunces',serif;font-size:24px;font-weight:700;margin-bottom:9px;line-height:1.2}
.deal-meta{display:flex;gap:18px;flex-wrap:wrap}
.meta-item{font-family:'DM Mono',monospace;font-size:11px;color:var(--text-muted);display:flex;align-items:center;gap:5px}
.meta-item span{color:var(--text-dim);font-weight:500;transition:color .3s}
.meta-item span.meta-warn{color:var(--moderate)}
.meta-item span.meta-danger{color:var(--critical)}
.meta-item span.meta-good{color:var(--good)}
.header-right{flex-shrink:0;text-align:right}
.header-actions{display:flex;align-items:center;gap:8px;margin-bottom:10px;justify-content:flex-end;flex-wrap:wrap}
.overall-label{font-family:'DM Mono',monospace;font-size:9px;letter-spacing:.12em;text-transform:uppercase;color:var(--text-muted);display:block;margin-bottom:6px}
.overall-badge{display:inline-block;padding:8px 16px;border:1.5px solid;border-radius:6px;font-family:'DM Mono',monospace;font-size:11px;font-weight:500;letter-spacing:.04em;transition:all .3s ease,transform .2s ease}
.rating-critical{background:var(--critical-bg);color:var(--critical);border-color:var(--critical-bd)!important}
.rating-needs{background:var(--moderate-bg);color:var(--moderate);border-color:var(--moderate-bd)!important}
.rating-minor{background:var(--high-bg);color:var(--high);border-color:var(--high-bd)!important}
.rating-good{background:var(--good-bg);color:var(--good);border-color:var(--good-bd)!important}

/* CONTROLS */
.ctrl-btn{display:flex;align-items:center;gap:6px;padding:6px 13px;background:var(--surface2);border:1.5px solid var(--border2);border-radius:100px;cursor:pointer;font-family:'DM Mono',monospace;font-size:10px;color:var(--text-dim);letter-spacing:.03em;transition:background .2s,color .15s,border-color .2s;white-space:nowrap}
.ctrl-btn:hover{background:var(--border);color:var(--text)}
.ctrl-icon{font-size:12px;line-height:1}

/* SUMMARY STRIP */
.summary-strip{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-bottom:14px}
.s-card{background:var(--surface);border:1px solid var(--border);border-radius:10px;padding:14px 16px;box-shadow:0 1px 3px rgba(0,0,0,.05);transition:background .25s,border-color .25s,box-shadow .15s}
.s-card:hover{box-shadow:0 3px 10px rgba(0,0,0,.09)}
.s-label{font-family:'DM Mono',monospace;font-size:9px;letter-spacing:.1em;text-transform:uppercase;color:var(--text-muted);margin-bottom:5px}
.s-value{font-family:'Fraunces',serif;font-size:20px;font-weight:700;color:var(--text);line-height:1;margin-bottom:3px;transition:color .3s}
.s-value.danger{color:var(--critical)}.s-value.good{color:var(--good)}.s-value.warn{color:var(--moderate)}
.s-sub{font-size:10px;color:var(--text-muted);line-height:1.4}

/* FILTER BAR */
.filter-bar{display:flex;align-items:center;gap:6px;margin-bottom:14px;flex-wrap:wrap}
.filter-label{font-family:'DM Mono',monospace;font-size:10px;letter-spacing:.1em;text-transform:uppercase;color:var(--text-muted);margin-right:2px}
.filter-btn{display:flex;align-items:center;gap:6px;padding:6px 12px;border-radius:100px;font-family:'DM Mono',monospace;font-size:10px;letter-spacing:.02em;cursor:pointer;border:1.5px solid var(--border);background:var(--surface);color:var(--text-dim);transition:all .15s}
.filter-btn:hover{border-color:var(--border2);color:var(--text)}
.filter-btn.active.f-all{background:var(--neutral-bg); color:var(--neutral); border-color:var(--neutral-bd)}
.filter-btn.active.f-critical{background:var(--critical-bg);color:var(--critical);border-color:var(--critical-bd)}
.filter-btn.active.f-high{background:var(--high-bg);color:var(--high);border-color:var(--high-bd)}
.filter-btn.active.f-moderate{background:var(--moderate-bg);color:var(--moderate);border-color:var(--moderate-bd)}
.filter-btn.active.f-info{background:var(--info-bg);color:var(--info);border-color:var(--info-bd)}
.f-dot{width:7px;height:7px;border-radius:50%;background:currentColor;flex-shrink:0}
.f-count{background:rgba(0,0,0,.08);border-radius:100px;padding:1px 6px;font-size:9px}

/* CALLOUT */
.critical-callout{display:none;background:var(--critical-bg);border:1.5px solid var(--critical-bd);border-radius:10px;padding:14px 18px;margin-bottom:12px;align-items:center;gap:14px;transition:background .25s,border-color .25s}
.critical-callout.visible{display:flex}
.cc-icon{font-size:20px;flex-shrink:0}
.cc-text{font-size:13px;color:var(--text-dim);line-height:1.55;flex:1}
.cc-text strong{color:var(--critical);font-weight:600}
.cc-amount{flex-shrink:0;text-align:right}
.cc-number{font-family:'Fraunces',serif;font-size:22px;font-weight:700;color:var(--critical);line-height:1}
.cc-sublabel{font-size:10px;color:var(--text-muted);margin-top:3px}

/* GROUP HEADERS */
.group-header{display:flex;align-items:center;gap:10px;margin:16px 0 8px}
.group-title{font-family:'DM Mono',monospace;font-size:10px;letter-spacing:.1em;text-transform:uppercase;color:var(--text-muted);white-space:nowrap}
.group-line{flex:1;height:1px;background:var(--border)}
.drag-hint{display:inline-flex;align-items:center;gap:5px;font-family:'DM Mono',monospace;font-size:10px;color:var(--accent);background:var(--accent-bg);border:1px solid var(--accent-bd);border-radius:100px;padding:3px 10px;white-space:nowrap}

/* SCORECARD */
.scorecard{display:flex;flex-direction:column;gap:5px}
.scorecard-row{background:var(--surface);border-radius:10px;border:1.5px solid var(--border);overflow:hidden;box-shadow:0 1px 3px rgba(0,0,0,.04);animation:fadeUp .35s ease both;transition:border-color .15s,box-shadow .15s,background .25s}
.scorecard-row:hover{border-color:var(--border2);box-shadow:0 3px 12px rgba(0,0,0,.08)}
.scorecard-row.expanded{border-color:var(--border2);box-shadow:0 4px 16px rgba(0,0,0,.10)}
.p-critical{border-left:4px solid var(--critical);background:#fffbfb}
.p-high{border-left:4px solid var(--high)}
.p-moderate{border-left:4px solid var(--moderate)}
.p-good{border-left:4px solid var(--good)}
.p-info{border-left:4px solid var(--neutral)}
.p-critical:hover,.p-critical.expanded{background:var(--critical-bg)}

.row-main{display:grid;grid-template-columns:32px 185px 1fr 155px 22px;align-items:center;gap:12px;padding:12px 15px;cursor:pointer}
.pi{width:30px;height:30px;border-radius:7px;display:flex;align-items:center;justify-content:center;font-size:14px;flex-shrink:0}
.pi-critical{background:var(--critical-bg)}.pi-high{background:var(--high-bg)}.pi-moderate{background:var(--moderate-bg)}
.pi-good{background:var(--good-bg)}.pi-neutral{background:var(--neutral-bg)}.pi-info{background:var(--info-bg)}
.row-label{display:flex;flex-direction:column;gap:2px}
.row-name{font-size:12px;font-weight:600;color:var(--text);line-height:1.3}
.row-cat{font-family:'DM Mono',monospace;font-size:9px;color:var(--text-muted);letter-spacing:.03em}
.row-exposure{font-family:'DM Mono',monospace;font-size:8px;color:var(--critical);margin-top:2px}

/* FLEXIBILITY BADGES */
.flex-badge{font-family:'DM Mono',monospace;font-size:8px;padding:1px 5px;border-radius:4px;margin-left:6px;vertical-align:middle;white-space:nowrap}
.flex-badge.flex{background:var(--good-bg);color:var(--good);border:1px solid var(--good-bd)}
.flex-badge.inflex{background:var(--moderate-bg);color:var(--moderate);border:1px solid var(--moderate-bd)}

/* SLIDER */
.slider-wrap{display:flex;flex-direction:column;gap:4px;user-select:none}
.slider-track{position:relative;height:10px;border-radius:100px;background:#e8ecf4;cursor:ew-resize}
.slider-zones{position:absolute;inset:0;display:flex;border-radius:100px;overflow:hidden;pointer-events:none}
.z1{flex:2;background:#bbf7d0}.z2{flex:2;background:#bae6fd}.z3{flex:2;background:#fed7aa}.z4{flex:2;background:#fecaca}
.z1,.z2,.z3{border-right:1px solid rgba(255,255,255,.7)}
.slider-indicator{position:absolute;top:50%;transform:translate(-50%,-50%);width:17px;height:17px;border-radius:50%;border:2.5px solid #fff;z-index:3;cursor:grab;box-shadow:0 1px 6px rgba(0,0,0,.25);transition:box-shadow .15s,transform .1s}
.slider-indicator:hover{transform:translate(-50%,-50%) scale(1.15)}
.slider-indicator:active{cursor:grabbing;transform:translate(-50%,-50%) scale(1.1)}
.ind-critical{background:var(--critical)}.ind-high{background:var(--high)}.ind-moderate{background:var(--moderate)}
.ind-neutral{background:var(--neutral)}.ind-good{background:var(--good)}.ind-gray{background:#94a3b8}
@keyframes pulse-dot{0%,100%{box-shadow:0 0 0 0 rgba(208,2,27,.4),0 1px 6px rgba(0,0,0,.25)}60%{box-shadow:0 0 0 6px rgba(208,2,27,0),0 1px 6px rgba(0,0,0,.25)}}
.ind-critical{animation:pulse-dot 2s ease infinite}
.ind-critical:hover,.ind-critical:active{animation:none}
.zone-tooltip{position:absolute;bottom:22px;transform:translateX(-50%);background:var(--text);color:var(--surface);font-family:'DM Mono',monospace;font-size:9px;padding:3px 8px;border-radius:4px;white-space:nowrap;pointer-events:none;opacity:0;transition:opacity .15s;z-index:10}
.zone-tooltip.visible{opacity:1}
.slider-labels{display:flex;justify-content:space-between;pointer-events:none}
.sl{font-family:'DM Mono',monospace;font-size:7px;color:var(--text-muted);letter-spacing:.03em}

/* BADGE */
.row-badge{display:flex;justify-content:flex-end}
.badge{font-family:'DM Mono',monospace;font-size:9px;letter-spacing:.06em;font-weight:500;padding:4px 10px;border-radius:5px;white-space:nowrap;text-align:center;border:1.5px solid;transition:background .3s,color .3s,border-color .3s}
.b-critical{background:var(--critical-bg);color:var(--critical);border-color:var(--critical-bd)}
.b-high{background:var(--high-bg);color:var(--high);border-color:var(--high-bd)}
.b-moderate{background:var(--moderate-bg);color:var(--moderate);border-color:var(--moderate-bd)}
.b-good{background:var(--good-bg);color:var(--good);border-color:var(--good-bd)}
.b-neutral{background:var(--neutral-bg);color:var(--neutral);border-color:var(--neutral-bd)}
.b-info{background:var(--info-bg);color:var(--info);border-color:var(--info-bd)}
.chevron{color:var(--text-muted);font-size:9px;transition:transform .2s;text-align:center;pointer-events:none}
.scorecard-row.expanded .chevron{transform:rotate(180deg)}

/* EXPAND PANEL */
.expand-panel{display:none;border-top:1px solid var(--border);background:var(--surface2);padding:16px 20px 18px;transition:background .25s,border-color .25s}
.expand-panel.open{display:block}
.expand-grid{display:grid;grid-template-columns:1fr 1fr;gap:18px}
.ex-block{display:flex;flex-direction:column;gap:5px}
.ex-label{font-family:'DM Mono',monospace;font-size:9px;letter-spacing:.1em;text-transform:uppercase;color:var(--text-muted)}
.ex-value{font-size:12px;color:var(--text-dim);line-height:1.6;transition:all .3s}
.ex-value strong{color:var(--text);font-weight:600}
.impact-box{display:inline-flex;align-items:center;gap:10px;padding:10px 14px;border-radius:8px;margin-top:5px;border:1.5px solid;transition:all .35s ease}
.ib-critical{background:var(--critical-bg);border-color:var(--critical-bd)}
.ib-high{background:var(--high-bg);border-color:var(--high-bd)}
.ib-moderate{background:var(--moderate-bg);border-color:var(--moderate-bd)}
.ib-good{background:var(--good-bg);border-color:var(--good-bd)}
.ib-neutral{background:var(--neutral-bg);border-color:var(--neutral-bd)}
.ib-info{background:var(--info-bg);border-color:var(--info-bd)}
.ib-main{font-family:'Fraunces',serif;font-size:20px;font-weight:700;line-height:1;transition:color .3s}
.ib-critical .ib-main{color:var(--critical)}.ib-high .ib-main{color:var(--high)}
.ib-moderate .ib-main{color:var(--moderate)}.ib-good .ib-main{color:var(--good)}
.ib-neutral .ib-main{color:var(--neutral)}.ib-info .ib-main{color:var(--info)}
.ib-sub{font-size:11px;color:var(--text-muted);line-height:1.5;transition:color .3s}
.rec-bar{margin-top:10px;padding:10px 13px;background:var(--accent-bg);border-left:3px solid var(--accent);border-radius:0 6px 6px 0;transition:all .3s}
.rec-label{font-family:'DM Mono',monospace;font-size:9px;letter-spacing:.1em;text-transform:uppercase;color:var(--accent);display:block;margin-bottom:4px;font-weight:500}
.rec-text{font-size:12px;color:var(--text-dim);line-height:1.6;transition:all .3s}
.savings-text{font-size:12px;color:var(--good);font-weight:500}
.savings-amount{font-family:'Fraunces',serif;font-size:16px;font-weight:700;color:var(--good);margin-left:auto}

@keyframes content-update{0%{opacity:.3;transform:translateY(2px)}100%{opacity:1;transform:translateY(0)}}
.updating{animation:content-update .3s ease}

/* FOOTER */
.footer{margin-top:32px;padding-top:22px;border-top:1px solid var(--border);display:flex;justify-content:space-between;align-items:center;gap:24px}
.footer-text{font-size:11px;color:var(--text-muted);line-height:1.7;max-width:500px}
.btn-row{display:flex;gap:10px}
.btn-ghost{padding:9px 18px;background:var(--surface);color:var(--text-dim);border:1.5px solid var(--border2);border-radius:7px;font-family:'DM Mono',monospace;font-size:11px;letter-spacing:.04em;cursor:pointer;transition:all .15s}
.btn-ghost:hover{background:var(--bg);color:var(--text);border-color:var(--text-muted)}
.btn-cta{padding:9px 20px;background:linear-gradient(135deg,#0f766e,#1d4ed8);color:#fff;border:none;border-radius:7px;font-family:'DM Mono',monospace;font-size:11px;font-weight:500;letter-spacing:.04em;cursor:pointer;transition:opacity .15s;box-shadow:0 2px 8px rgba(15,118,110,.3)}
.btn-cta:hover{opacity:.88}

@keyframes fadeUp{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
.scorecard-row.hidden{display:none}
.empty-state{display:none;text-align:center;padding:48px;color:var(--text-muted);font-size:13px}
.empty-state.visible{display:block}
.group-hidden{display:none}

/* ══ INTAKE MODAL ══════════════════════════════════════════ */
.intake-overlay{position:fixed;inset:0;background:rgba(0,0,0,.65);backdrop-filter:blur(6px);z-index:1000;display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none;transition:opacity .25s}
.intake-overlay.open{opacity:1;pointer-events:all}
.intake-modal{background:var(--surface);border:1px solid var(--border);border-radius:18px;width:min(680px,95vw);max-height:90vh;display:flex;flex-direction:column;box-shadow:0 24px 80px rgba(0,0,0,.35);transform:translateY(24px) scale(.97);transition:transform .3s cubic-bezier(.34,1.56,.64,1)}
.intake-overlay.open .intake-modal{transform:none}
.intake-header{padding:22px 24px 0;display:flex;align-items:flex-start;justify-content:space-between;flex-shrink:0}
.intake-title{display:flex;align-items:center;gap:14px}
.intake-icon{width:42px;height:42px;background:linear-gradient(135deg,var(--accent),#6ee7b7);border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0}
.intake-heading{font-family:'DM Mono',monospace;font-size:17px;font-weight:700;color:var(--text)}
.intake-sub{font-size:12px;color:var(--text-dim);margin-top:3px}
.intake-close{background:none;border:1px solid var(--border);border-radius:8px;width:32px;height:32px;cursor:pointer;color:var(--text-dim);font-size:14px;display:flex;align-items:center;justify-content:center;flex-shrink:0;transition:all .15s}
.intake-close:hover{background:var(--bg);color:var(--text)}
.intake-tabs{display:flex;gap:8px;padding:18px 24px 0;flex-shrink:0}
.itab{flex:1;padding:10px;border:1px solid var(--border);border-radius:10px;background:none;cursor:pointer;color:var(--text-dim);font-size:13px;font-weight:500;display:flex;align-items:center;justify-content:center;gap:7px;transition:all .15s}
.itab.active{background:var(--accent);color:#fff;border-color:var(--accent)}
.itab:not(.active):hover{background:var(--bg)}
.ipanel{display:none;padding:16px 24px 0;flex:1;min-height:0}
.ipanel.active{display:flex;flex-direction:column}
.intake-textarea{flex:1;min-height:260px;resize:none;background:var(--bg);border:1px solid var(--border);border-radius:10px;padding:14px;font-size:13px;color:var(--text);font-family:'DM Mono',monospace;line-height:1.6;outline:none;transition:border-color .15s}
.intake-textarea:focus{border-color:var(--accent)}
.upload-zone{flex:1;min-height:260px;border:2px dashed var(--border);border-radius:12px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:10px;cursor:pointer;transition:all .2s;background:var(--bg)}
.upload-zone:hover,.upload-zone.dragover{border-color:var(--accent);background:rgba(99,179,237,.06)}
.upload-icon{font-size:40px;opacity:.5}
.upload-label{font-size:14px;font-weight:600;color:var(--text)}
.upload-sub{font-size:12px;color:var(--text-dim)}
.upload-filename{font-size:12px;color:var(--accent);font-family:'DM Mono',monospace;margin-top:4px;font-weight:600}
.intake-error{margin:12px 24px 0;padding:10px 14px;background:#fef2f2;border:1px solid #fecaca;border-radius:8px;font-size:12px;color:#dc2626}
.intake-footer{padding:16px 24px 18px;display:flex;align-items:center;justify-content:space-between;flex-shrink:0;border-top:1px solid var(--border);margin-top:16px}
.intake-hint{font-size:12px;color:var(--text-dim);max-width:280px;line-height:1.5}
.intake-actions{display:flex;gap:10px}
.intake-cancel{padding:9px 18px;border:1px solid var(--border);border-radius:8px;background:none;cursor:pointer;color:var(--text-dim);font-size:13px;transition:all .15s}
.intake-cancel:hover{background:var(--bg)}
.intake-analyze{padding:9px 22px;background:linear-gradient(135deg,var(--accent),#38bdf8);border:none;border-radius:8px;cursor:pointer;color:#fff;font-size:13px;font-weight:700;font-family:'DM Mono',monospace;transition:all .2s;box-shadow:0 4px 14px rgba(99,179,237,.35)}
.intake-analyze:hover{transform:translateY(-1px);box-shadow:0 6px 20px rgba(99,179,237,.45)}
.intake-analyze:disabled{opacity:.5;cursor:not-allowed;transform:none;box-shadow:none}

/* ══ ANALYZING OVERLAY ══ */
.analyzing-overlay{position:fixed;inset:0;background:rgba(0,0,0,.75);backdrop-filter:blur(8px);z-index:1100;display:flex;align-items:center;justify-content:center}
.analyzing-box{background:var(--surface);border:1px solid var(--border);border-radius:18px;padding:40px 48px;text-align:center;box-shadow:0 24px 80px rgba(0,0,0,.4);min-width:320px}
.analyzing-spinner{width:52px;height:52px;border:3px solid var(--border);border-top-color:var(--accent);border-radius:50%;animation:spin 1s linear infinite;margin:0 auto 20px}
@keyframes spin{to{transform:rotate(360deg)}}
.analyzing-label{font-family:'DM Mono',monospace;font-size:16px;font-weight:700;color:var(--text);margin-bottom:8px}
.analyzing-sub{font-size:13px;color:var(--text-dim);margin-bottom:20px}
.analyzing-progress{height:4px;background:var(--border);border-radius:2px;overflow:hidden}
.analyzing-bar{height:100%;background:linear-gradient(90deg,var(--accent),#38bdf8);border-radius:2px;width:0%;transition:width .4s ease}

/* ══ FAB ══ */
.fab-analyze{position:fixed;bottom:28px;right:28px;z-index:900;background:linear-gradient(135deg,#1e3a5f,var(--accent));border:none;border-radius:14px;padding:13px 20px;cursor:pointer;color:#fff;display:flex;align-items:center;gap:9px;box-shadow:0 8px 24px rgba(0,0,0,.25);transition:all .2s;font-family:'DM Mono',monospace}
.fab-analyze:hover{transform:translateY(-2px);box-shadow:0 12px 32px rgba(0,0,0,.3)}
.fab-icon{font-size:18px}
.fab-label{font-size:13px;font-weight:700;letter-spacing:.02em}

/* ══ RESULT FLASH ══ */
.update-flash{animation:flash .6s ease}
@keyframes flash{0%,100%{opacity:1}50%{opacity:.4}}

[data-theme="dark"] .intake-error{background:#450a0a;border-color:#991b1b;color:#fca5a5}

/* Responsive adjustments */
@media (max-width: 768px) {
  .header{flex-direction:column;align-items:flex-start}
  .header-right{text-align:left;width:100%}
  .header-actions{justify-content:flex-start}
  .row-main{grid-template-columns:32px 1fr 60px 22px}
  .row-main .slider-wrap{display:none}
  .expand-grid{grid-template-columns:1fr}
  .footer{flex-direction:column;align-items:flex-start}
}
